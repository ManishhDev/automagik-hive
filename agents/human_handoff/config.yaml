# Human Handoff Agent Configuration
# Extracted from existing agents/specialists/human_handoff_agent.py

agent:
  agent_id: "human-handoff-specialist"
  version: 27
  name: "Especialista em Transfer√™ncia Humana"
  role: "Especialista em Transfer√™ncia Humana"
  description: "Especialista em escala√ß√£o para atendimento humano e gest√£o de frustra√ß√µes"

model:
  provider: "anthropic"
  id: "claude-sonnet-4-20250514"
  temperature: 0.8
  max_tokens: 1500

# Portuguese instructions for escalation management
instructions: |
  üéØ Voc√™ √© especialista em escala√ß√£o para atendimento humano do PagBank.
  
  QUANDO RECEBER UMA SOLICITA√á√ÉO DE ESCALA√á√ÉO:
  1. Use IMEDIATAMENTE a ferramenta trigger_human_handoff_workflow
  2. Passe toda informa√ß√£o dispon√≠vel: mensagem do cliente, hist√≥rico, motivo
  3. A ferramenta executar√° o workflow completo e retornar√° o protocolo
  4. Repasse essa informa√ß√£o ao cliente
  
  PAR√ÇMETROS PARA trigger_human_handoff_workflow:
  - customer_message: mensagem atual do cliente
  - escalation_reason: "explicit_request" ou "frustration_detected" 
  - conversation_history: todo o hist√≥rico da conversa
  - urgency_level: "medium" (padr√£o) ou "high" se urgente
  
  IMPORTANTE:
  - Use a ferramenta SEMPRE que houver escala√ß√£o
  - A ferramenta usa external_execution=True, ent√£o pausa o agente
  - Aguarde o resultado da ferramenta e repasse ao cliente
  - Seja emp√°tico e profissional
  
  Sempre responda em portugu√™s brasileiro.

# Knowledge base filtering
knowledge_filter:
  business_unit: "Human Handoff"

# Tools available to this agent
tools:
  - "trigger_human_handoff_workflow"

# Storage configuration
storage:
  type: "postgres"
  table_name: "human_handoff_specialist"
  auto_upgrade_schema: true

# Memory and history settings
memory:
  add_history_to_messages: true
  num_history_runs: 10  # More history for better context

# Display settings
markdown: false
show_tool_calls: true

# CRITICAL: Specialist response constraints (to prevent verbose responses)
success_criteria: "SUCESSO = Processou transfer√™ncia humana de forma emp√°tica e eficiente em m√°ximo 200 palavras"
expected_output: "Resposta concisa e emp√°tica com: 1) Confirma√ß√£o da transfer√™ncia, 2) Protocolo gerado, 3) Expectativas claras. EVITAR textos longos desnecess√°rios."

# Escalation criteria (from human_handoff_detector.py)
escalation_triggers:
  frustration_indicators:
    - "droga"
    - "merda" 
    - "porra"
    - "caralho"
    - "desgra√ßa"
    - "bosta"
    - "inferno"
    - "puta"
    - "cacete"
    - "foda"
  explicit_requests:
    - "quero falar com humano"
    - "quero atendente"
    - "falar com pessoa"
    - "atendimento humano"
    - "me transfere"
    - "pessoa real"
    - "n√£o quero rob√¥"
    - "chega de rob√¥"
  caps_threshold: 0.7  # 70% caps = yelling
  
# Protocol generation
protocol_fields:
  - "customer_name"
  - "customer_cpf"
  - "issue_description"
  - "previous_attempts"
  - "urgency_level"
  - "customer_emotion"
  - "recommended_action"

# WhatsApp integration
# Now handled by dedicated WhatsApp Notifier Agent
whatsapp:
  enabled: true
  instance: "pagbank_support"
  agent: "whatsapp-notifier"  # Dedicated MCP-enabled agent